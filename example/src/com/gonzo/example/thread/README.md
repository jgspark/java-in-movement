# 스레드

## 스레드 풀

* 벽렬 처리 작업이 많아 지면서 스레드 개수를 증가되고 그에 따른 스레드 생성과 스케쥴링으로 인해 CPU가 바빠져서 메모리 사용량이 늘어난다. (어플리케이션 성능 저하)
* 갑작스러운 벽렬 작업의 폭증으로 인한 스레드 폭증을 막으려면 스레드 풀을 사용해야 한다.
* 스레드 풀은 작업 처리에 사용되는 스레드를 제한된 개수만큼 정해놓고 작업 큐에 들어오는 작업들을 하나씩 스레드가 맡아서 처리를 한다.
* 작업 처리가 끝난 스레드는 다시 작업 큐 에서 새로운 작업을 가져와 처리한다.
* 그렇기 때문에 작업 처리 요청이 폭증되어도 스레드의 전체 개수가 늘어나지 않으므로 어플리케이션의 성능이 급격하게 저하되지 않는다. 

## 스레드

* 스레드는 프로세스 내에서 실행되는 하나의 흐름 단위
* 스레드를 생성을 하면 jvm 에서 별도의 메모리 공간에 할당을 한다. 
* 스레드는 자신의 스택을 할당을 받는다. 하지만 힙 영역의 경우 공유가 된다. (모든 스레드가 힙영역을 공유한다.)
* A 쓰레드가 만든 인스턴스 참조값 만 알면 B 스레드에서도 A 스레드가 만든 인스턴스에 접근이 가능하다. 
* 스래드간의 데이터를 주고 받을때 힙영역을 활용한다. 

## 멀티 스레드

* 멀티 스레드는 동시성 또는 병렬성으로 실행이 된다.
* 동시성은 멀티 작업을 위해 하나의 코어에서 멀티 스테드가 번갈아 가며 실행하는 성질을 의미
* 병렬성은 멀티 작업을 위해 멀티 코어에서 개별 스레드를 동시에 실행하는 성질을 말한다.
* 스레드 개수가 코어의 수보다 많은 경우 스레드를 어떤 순서에 의해 동시성으로 실행을 할것인가 결정을 해야하는데 이것을 `스레드 스케줄링`이라고 한다.
* 스레드 스케줄링에 의해 스레드들은 아주 짧은 시간에 번갈아 가면서 run 메소드를 조금식 수행을 한다.
* 자바의 스레드 스케줄링은 `우선순위 방식` 과 `정해진 time slice 만큼 실행` 을 하고 다른 스레드를 실행하는 방식의 순환 할당 방식이다.
* 우선순위는 개발자가 코드로 제어가 가능하다.

### 동기화 메소드와 동기화 블록

* 스레드가 사용중인 객체를 다른 스레드가 변경을 할 수 없도록 잠금을 걸어서 다른 스레드가 사용할 수 없게 해야 한다.
* 메소드 전체를 임계영역으로 만들고 싶다면 메소드 선언에 `synchronized` 키워드를 사용을 한다.
* 하지만 일부만 임계영역으로 만들고 싶다면 동기화 블록을 만단다.

```java
// 메소드 전체를 임계영역으로 만들기 
public synchronized void method(){

        }

public void method(){
// 여러 스레드가 실행 가능한 영역 
synchronized(공유 객체){
        // 단하나의 스레드만 실행
        }
        // 여러 스레드가 실행 가능한 영역 
        }
```
